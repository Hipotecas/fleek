"use strict";(self.webpackChunkdocta=self.webpackChunkdocta||[]).push([[4034],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),c=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(s.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),u=c(n),h=a,m=u["".concat(s,".").concat(h)]||u[h]||d[h]||l;return n?r.createElement(m,o(o({ref:t},p),{},{components:n})):r.createElement(m,o({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,o=new Array(l);o[0]=h;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[u]="string"==typeof e?e:a,o[1]=i;for(var c=2;c<l;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},1035:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>c});var r=n(7462),a=(n(7294),n(3905));const l={template:"post",draft:!1,hide_title:!1,title:"How to secure a node with SSL/TSL",slug:"how-to-secure-a-node-with-ssl-tsl",date:new Date("2023-01-03T02:00:00.000Z"),canonical:"",description:"Quick reference to secure a Node with SSL/TSL",category:"Reference",tags:["Reference","Git","Fleek Network","SSL","TSL","HTTPS","security"]},o=void 0,i={unversionedId:"Security/how-to-secure-a-node-with-ssl-tsl",id:"Security/how-to-secure-a-node-with-ssl-tsl",title:"How to secure a node with SSL/TSL",description:"Quick reference to secure a Node with SSL/TSL",source:"@site/reference/Security/how-to-secure-a-node-with-ssl-tsl.md",sourceDirName:"Security",slug:"/Security/how-to-secure-a-node-with-ssl-tsl",permalink:"/reference/Security/how-to-secure-a-node-with-ssl-tsl",draft:!1,editUrl:"https://github.com/fleek-network/fleek-network-docs/edit/main/reference/Security/how-to-secure-a-node-with-ssl-tsl.md",tags:[{label:"Reference",permalink:"/reference/tags/reference"},{label:"Git",permalink:"/reference/tags/git"},{label:"Fleek Network",permalink:"/reference/tags/fleek-network"},{label:"SSL",permalink:"/reference/tags/ssl"},{label:"TSL",permalink:"/reference/tags/tsl"},{label:"HTTPS",permalink:"/reference/tags/https"},{label:"security",permalink:"/reference/tags/security"}],version:"current",lastUpdatedAt:1676457546,formattedLastUpdatedAt:"Feb 15, 2023",frontMatter:{template:"post",draft:!1,hide_title:!1,title:"How to secure a node with SSL/TSL",slug:"how-to-secure-a-node-with-ssl-tsl",date:"2023-01-03T02:00:00.000Z",canonical:"",description:"Quick reference to secure a Node with SSL/TSL",category:"Reference",tags:["Reference","Git","Fleek Network","SSL","TSL","HTTPS","security"]},sidebar:"defaultSidebar",previous:{title:"How to checkout a commit in project history",permalink:"/reference/Git/how-to-checkout-a-commit-in-project-history"},next:{title:"Finding help in the command-line",permalink:"/reference/Ursa-CLI/finding-help-in-the-command-line"}},s={},c=[],p={toc:c};function u(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Change the directory to the Ursa directory in your file system:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"cd <PATH-TO-URSA-CLI-PROJECT-SOURCE>\n")),(0,a.kt)("p",null,"Set up the DNS settings for a Node server:"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Host"),(0,a.kt)("th",{parentName:"tr",align:null},"Answer"),(0,a.kt)("th",{parentName:"tr",align:null},"TTL"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"A"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"<YOUR-DOMAIN-NAME>")),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"<SERVER-PUBLIC-IP-ADDRESS>")),(0,a.kt)("td",{parentName:"tr",align:null},"300")))),(0,a.kt)("p",null,"Here's an example:"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Host"),(0,a.kt)("th",{parentName:"tr",align:null},"Answer"),(0,a.kt)("th",{parentName:"tr",align:null},"TTL"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"A"),(0,a.kt)("td",{parentName:"tr",align:null},"fleek-network-node.fleek.xyz"),(0,a.kt)("td",{parentName:"tr",align:null},"181.196.118.156"),(0,a.kt)("td",{parentName:"tr",align:null},"300")))),(0,a.kt)("p",null,"Verify the DNS records"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"dig fleek-network-node.fleek.xyz +nostats +nocomments +nocmd\n")),(0,a.kt)("p",null,"The result should contain a response with the ",(0,a.kt)("inlineCode",{parentName:"p"},"<SERVER-PUBLIC-IP-ADDRESS>")," set in the DNS record. Your domain should point to the machine address."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},";`<YOUR-DOMAIN-NAME>`.      IN  A\n`<YOUR-DOMAIN-NAME>`.       484 IN  A   `<SERVER-PUBLIC-IP-ADDRESS>` \n")),(0,a.kt)("p",null,"Update the Nginx ",(0,a.kt)("inlineCode",{parentName:"p"},"app.conf"),", providing the ",(0,a.kt)("inlineCode",{parentName:"p"},"server_name")," to match the desired domain name ",(0,a.kt)("inlineCode",{parentName:"p"},"<YOUR-DOMAIN-NAMe>")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"server {\n    listen 80;\n    listen [::]:80;\n    server_name `<YOUR-DOMAIN-NAME>`;\n\n    ...\n}\n\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name `<YOUR-DOMAIN-NAME>`;\n\n    ...\n}\n")),(0,a.kt)("p",null,"\ud83d\udca1 We are using the three dots ",(0,a.kt)("inlineCode",{parentName:"p"},"...")," to represent the text that is omitted to keep it short. You are not supposed to add the dots or delete any other text apart from replacing the ",(0,a.kt)("inlineCode",{parentName:"p"},"server_name")," value with your desired domain."),(0,a.kt)("p",null,"If you have followed our introductory guides, you have probably commented out or removed the SSL configuration, you can find the ",(0,a.kt)("inlineCode",{parentName:"p"},"app.conf")," file ",(0,a.kt)("a",{parentName:"p",href:"https://raw.githubusercontent.com/fleek-network/ursa/cd6fb3d21ce647dc3f06ee9128ba2a4164623ee5/docker/full-node/data/nginx/app.conf"},"here"),". This is pointing to the file version at a certain commit in history, recent versions might differ! Beware, that this is highly customizable and we might make tweaks in any earlier version of ",(0,a.kt)("inlineCode",{parentName:"p"},"ursa")," which that guide might not consider. Check our original repository on recent commits for any updates!"),(0,a.kt)("p",null," Replace the pathname with your custom domain ",(0,a.kt)("inlineCode",{parentName:"p"},"<YOUR-DOMAIN-NAME>")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"# SSL code\nssl_certificate /etc/letsencrypt/live/<YOUR-DOMAIN-NAME>/fullchain.pem;\nssl_certificate_key /etc/letsencrypt/live/<YOUR-DOMAIN-NAME>/privkey.pem;\n")),(0,a.kt)("p",null,"Run the Let's encrypt initialization script to generate the SSL/TLS certificates. The process is the following:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Create a dummy certificate"),(0,a.kt)("li",{parentName:"ul"},"Start Nginx"),(0,a.kt)("li",{parentName:"ul"},"Delete the dummy certificate"),(0,a.kt)("li",{parentName:"ul"},"Request the real certificates")),(0,a.kt)("p",null,"Change the directory to the location where the ",(0,a.kt)("inlineCode",{parentName:"p"},"init-letsencrypt.sh")," is located."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"cd docker/full-node\n")),(0,a.kt)("p",null,"Run the script by executing the command and providing the arguments to ",(0,a.kt)("inlineCode",{parentName:"p"},"EMAIL")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"DOMAINS"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},'EMAIL="<VALID EMAIL>" DOMAINS="<DOMAIN WITH CORRECT DNS RECORDS>" ./init-letsencrypt.sh\n')),(0,a.kt)("p",null,"\ud83d\udca1 This will only work you've followed the previous steps and confirmed that the DNS records are correct. Also, if multiple domains are provided, the certificates will be stored under the first one."),(0,a.kt)("p",null,"If successful, you should get a long response (we replaced the long text with ",(0,a.kt)("inlineCode",{parentName:"p"},"..."),") with the following:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"...\n\nSuccessfully received certificate.\nCertificate is saved at: /etc/letsencrypt/live/fleek-network-node.fleek.xyz/fullchain.pem\nKey is saved at:         /etc/letsencrypt/live/fleek-network-node.fleek.xyz/privkey.pem\nThis certificate expires on 2023-04-25.\nThese files will be updated when the certificate renews.\nNEXT STEPS:\n- The certificate will need to be renewed before it expires. Certbot can automatically renew the certificate in the background, but you may need to take steps to enable that functionality. See https://certbot.org/renewal-setup for instructions.\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\nIf you like Certbot, please consider supporting our work by:\n * Donating to ISRG / Let's Encrypt:   https://letsencrypt.org/donate\n * Donating to EFF:                    https://eff.org/donate-le\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n### Reloading nginx ...\n2023/01/25 18:56:34 [notice] 17#17: signal process started\n")),(0,a.kt)("p",null,"Do a health check anywhere in the web to confirm"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"curl https://<YOUR DOMAIN NAME>/ping\n")),(0,a.kt)("p",null,"Should get the response back ",(0,a.kt)("inlineCode",{parentName:"p"},"pong")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"pong\n")),(0,a.kt)("p",null,"For longer detailed instructions, check our guide ","[Securing a Node with SSL/TSL]","(../../guides/Network nodes/fleek-network-securing-a-node-with-ssl-tls)."))}u.isMDXComponent=!0}}]);